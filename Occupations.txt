select Doctor,Professor,Singer,Actor from (SELECT ROW_NUMBER() OVER (PARTITION BY OCCUPATION ORDER BY NAME) [RowNumber], *
FROM OCCUPATIONS) AS BangNguon
PIVOT
(
MIN(Name)
FOR Occupation IN ([Doctor], [Professor],[Singer],[Actor])
) AS BangChuyen;